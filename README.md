# ShulinWang
王澍霖
## Introduction

### FT-IR
When a beam of infrared light with continuous wavelength passes through a substance, and the vibration or rotation frequency of a group in the molecule is the same as that of the infrared light, the absorbed energy of the molecule will jump from the original vibration (rotation) kinetic energy level of the ground state to the vibration (rotation) kinetic energy level with higher energy. After the molecule absorbs the infrared radiation, the vibration and rotation energy levels will transition, and the light at that wavelength will be absorbed by the substance. Therefore, infrared spectroscopy is essentially an analytical method to determine the molecular structure and identify compounds according to the relative vibration and molecular rotation of atoms in molecules. The infrared spectrum can be obtained by recording the absorption of infrared light.
### keras
Keras is an open source neural network library written in Python and capable of running on top of either TensorFlow, CNTK or Theano.
- Allows for easy and fast prototyping
- Supports both convolutional networks and recurrent networks, as well as combinations of the two
- Runs seamlessly on CPU and GPU
- Keras is compatible with Python 2.7 and onwards

### Deep Learning
"Deep Learning is the application to learning tasks of artificial neural networks(ANNs) that contain more than one hidden layer. Deep learning is part of Machine Learning methods based on learning data representations. Learning can be supervised, parially supervised or unsupervised."

###Infrared spectrogram data set

The data set contains 10 types of infrared spectral images, a total of 15816 images

Data set - > {4asps' - > 5100 images, '5adinac' - > 755 images, '6aela' - > 725 images, '7Ah' - > 840 images, '10pasc' - > 672 images, '11p' - > 780 images, '15ct' - > 3129 images, '16epa' - > 567 images, 'alcohol'_ Phenol '- > 1576 pictures,' aldehyde_ Ketone '- > 1672 pictures}


## Required Libraries
- os
- tensorflow
- keras 
- matplotlib 
- numpy
- Sklearn
  

## Project structure
\figures - folder for images in README.md <br>
\logs - Tensorboard logs <br>
\models - folder containing resnet, inception and attention modules <br>
\weights - folder containing trained weights on dataset <br>
CTxResnet20-Cbam.ipynb - Resnet20-Cbam training and visualization file <br>
generator.py - File for createing augmented data from dataset <br>
README.md - description of this project

## Resnet20-Cbam Model
The Resnet20-Cbam model used is shown below
<details> 
  <summary>Resnet20-Cbam Model </summary>

```
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 224, 224, 16) 448         input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 224, 224, 16) 64          conv2d[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 224, 224, 16) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 224, 224, 16) 2320        activation[0][0]                 
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 224, 224, 16) 64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 224, 224, 16) 0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 224, 224, 16) 2320        activation_1[0][0]               
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 224, 224, 16) 64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 16)           0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
global_max_pooling2d (GlobalMax (None, 16)           0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
reshape (Reshape)               (None, 1, 1, 16)     0           global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1, 1, 16)     0           global_max_pooling2d[0][0]       
__________________________________________________________________________________________________
dense (Dense)                   (None, 1, 1, 2)      34          reshape[0][0]                    
                                                                 reshape_1[0][0]                  
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1, 1, 16)     48          dense[0][0]                      
                                                                 dense[1][0]                      
__________________________________________________________________________________________________
add (Add)                       (None, 1, 1, 16)     0           dense_1[0][0]                    
                                                                 dense_1[1][0]                    
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 1, 1, 16)     0           add[0][0]                        
__________________________________________________________________________________________________
multiply (Multiply)             (None, 224, 224, 16) 0           batch_normalization_2[0][0]      
                                                                 activation_2[0][0]               
__________________________________________________________________________________________________
lambda (Lambda)                 (None, 224, 224, 1)  0           multiply[0][0]                   
__________________________________________________________________________________________________
lambda_1 (Lambda)               (None, 224, 224, 1)  0           multiply[0][0]                   
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 224, 224, 2)  0           lambda[0][0]                     
                                                                 lambda_1[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 224, 224, 1)  98          concatenate[0][0]                
__________________________________________________________________________________________________
multiply_1 (Multiply)           (None, 224, 224, 16) 0           multiply[0][0]                   
                                                                 conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 224, 224, 16) 0           activation[0][0]                 
                                                                 multiply_1[0][0]                 
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 224, 224, 16) 0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 224, 224, 16) 2320        activation_3[0][0]               
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 224, 224, 16) 64          conv2d_4[0][0]                   
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 224, 224, 16) 0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 224, 224, 16) 2320        activation_4[0][0]               
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 224, 224, 16) 64          conv2d_5[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 16)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
global_max_pooling2d_1 (GlobalM (None, 16)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
reshape_2 (Reshape)             (None, 1, 1, 16)     0           global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
reshape_3 (Reshape)             (None, 1, 1, 16)     0           global_max_pooling2d_1[0][0]     
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1, 1, 2)      34          reshape_2[0][0]                  
                                                                 reshape_3[0][0]                  
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 1, 1, 16)     48          dense_2[0][0]                    
                                                                 dense_2[1][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 1, 1, 16)     0           dense_3[0][0]                    
                                                                 dense_3[1][0]                    
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 1, 1, 16)     0           add_2[0][0]                      
__________________________________________________________________________________________________
multiply_2 (Multiply)           (None, 224, 224, 16) 0           batch_normalization_4[0][0]      
                                                                 activation_5[0][0]               
__________________________________________________________________________________________________
lambda_2 (Lambda)               (None, 224, 224, 1)  0           multiply_2[0][0]                 
__________________________________________________________________________________________________
lambda_3 (Lambda)               (None, 224, 224, 1)  0           multiply_2[0][0]                 
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 224, 224, 2)  0           lambda_2[0][0]                   
                                                                 lambda_3[0][0]                   
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 224, 224, 1)  98          concatenate_1[0][0]              
__________________________________________________________________________________________________
multiply_3 (Multiply)           (None, 224, 224, 16) 0           multiply_2[0][0]                 
                                                                 conv2d_6[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 224, 224, 16) 0           activation_3[0][0]               
                                                                 multiply_3[0][0]                 
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 224, 224, 16) 0           add_3[0][0]                      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 224, 224, 16) 2320        activation_6[0][0]               
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 224, 224, 16) 64          conv2d_7[0][0]                   
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 224, 224, 16) 0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 224, 224, 16) 2320        activation_7[0][0]               
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 224, 224, 16) 64          conv2d_8[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 16)           0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
global_max_pooling2d_2 (GlobalM (None, 16)           0           batch_normalization_6[0][0]      
__________________________________________________________________________________________________
reshape_4 (Reshape)             (None, 1, 1, 16)     0           global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
reshape_5 (Reshape)             (None, 1, 1, 16)     0           global_max_pooling2d_2[0][0]     
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 1, 1, 2)      34          reshape_4[0][0]                  
                                                                 reshape_5[0][0]                  
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 1, 1, 16)     48          dense_4[0][0]                    
                                                                 dense_4[1][0]                    
__________________________________________________________________________________________________
add_4 (Add)                     (None, 1, 1, 16)     0           dense_5[0][0]                    
                                                                 dense_5[1][0]                    
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 1, 1, 16)     0           add_4[0][0]                      
__________________________________________________________________________________________________
multiply_4 (Multiply)           (None, 224, 224, 16) 0           batch_normalization_6[0][0]      
                                                                 activation_8[0][0]               
__________________________________________________________________________________________________
lambda_4 (Lambda)               (None, 224, 224, 1)  0           multiply_4[0][0]                 
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 224, 224, 1)  0           multiply_4[0][0]                 
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 224, 224, 2)  0           lambda_4[0][0]                   
                                                                 lambda_5[0][0]                   
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 224, 224, 1)  98          concatenate_2[0][0]              
__________________________________________________________________________________________________
multiply_5 (Multiply)           (None, 224, 224, 16) 0           multiply_4[0][0]                 
                                                                 conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_5 (Add)                     (None, 224, 224, 16) 0           activation_6[0][0]               
                                                                 multiply_5[0][0]                 
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 224, 224, 16) 0           add_5[0][0]                      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 112, 112, 32) 4640        activation_9[0][0]               
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 112, 112, 32) 128         conv2d_10[0][0]                  
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 112, 32) 0           batch_normalization_7[0][0]      
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 112, 112, 32) 9248        activation_10[0][0]              
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 112, 112, 32) 128         conv2d_11[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 32)           0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
global_max_pooling2d_3 (GlobalM (None, 32)           0           batch_normalization_8[0][0]      
__________________________________________________________________________________________________
reshape_6 (Reshape)             (None, 1, 1, 32)     0           global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
reshape_7 (Reshape)             (None, 1, 1, 32)     0           global_max_pooling2d_3[0][0]     
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 1, 1, 4)      132         reshape_6[0][0]                  
                                                                 reshape_7[0][0]                  
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1, 1, 32)     160         dense_6[0][0]                    
                                                                 dense_6[1][0]                    
__________________________________________________________________________________________________
add_6 (Add)                     (None, 1, 1, 32)     0           dense_7[0][0]                    
                                                                 dense_7[1][0]                    
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 1, 1, 32)     0           add_6[0][0]                      
__________________________________________________________________________________________________
multiply_6 (Multiply)           (None, 112, 112, 32) 0           batch_normalization_8[0][0]      
                                                                 activation_11[0][0]              
__________________________________________________________________________________________________
lambda_6 (Lambda)               (None, 112, 112, 1)  0           multiply_6[0][0]                 
__________________________________________________________________________________________________
lambda_7 (Lambda)               (None, 112, 112, 1)  0           multiply_6[0][0]                 
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 112, 112, 2)  0           lambda_6[0][0]                   
                                                                 lambda_7[0][0]                   
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 112, 112, 1)  98          concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 112, 112, 32) 544         activation_9[0][0]               
__________________________________________________________________________________________________
multiply_7 (Multiply)           (None, 112, 112, 32) 0           multiply_6[0][0]                 
                                                                 conv2d_13[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 112, 112, 32) 0           conv2d_12[0][0]                  
                                                                 multiply_7[0][0]                 
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 112, 112, 32) 0           add_7[0][0]                      
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 112, 112, 32) 9248        activation_12[0][0]              
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 112, 112, 32) 128         conv2d_14[0][0]                  
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 112, 112, 32) 0           batch_normalization_9[0][0]      
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 112, 112, 32) 9248        activation_13[0][0]              
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 112, 112, 32) 128         conv2d_15[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 32)           0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
global_max_pooling2d_4 (GlobalM (None, 32)           0           batch_normalization_10[0][0]     
__________________________________________________________________________________________________
reshape_8 (Reshape)             (None, 1, 1, 32)     0           global_average_pooling2d_4[0][0] 
__________________________________________________________________________________________________
reshape_9 (Reshape)             (None, 1, 1, 32)     0           global_max_pooling2d_4[0][0]     
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 1, 1, 4)      132         reshape_8[0][0]                  
                                                                 reshape_9[0][0]                  
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 1, 1, 32)     160         dense_8[0][0]                    
                                                                 dense_8[1][0]                    
__________________________________________________________________________________________________
add_8 (Add)                     (None, 1, 1, 32)     0           dense_9[0][0]                    
                                                                 dense_9[1][0]                    
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 1, 1, 32)     0           add_8[0][0]                      
__________________________________________________________________________________________________
multiply_8 (Multiply)           (None, 112, 112, 32) 0           batch_normalization_10[0][0]     
                                                                 activation_14[0][0]              
__________________________________________________________________________________________________
lambda_8 (Lambda)               (None, 112, 112, 1)  0           multiply_8[0][0]                 
__________________________________________________________________________________________________
lambda_9 (Lambda)               (None, 112, 112, 1)  0           multiply_8[0][0]                 
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 112, 112, 2)  0           lambda_8[0][0]                   
                                                                 lambda_9[0][0]                   
__________________________________________________________________________________________________
conv2d_16 (Conv2D)              (None, 112, 112, 1)  98          concatenate_4[0][0]              
__________________________________________________________________________________________________
multiply_9 (Multiply)           (None, 112, 112, 32) 0           multiply_8[0][0]                 
                                                                 conv2d_16[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 112, 112, 32) 0           activation_12[0][0]              
                                                                 multiply_9[0][0]                 
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 112, 112, 32) 0           add_9[0][0]                      
__________________________________________________________________________________________________
conv2d_17 (Conv2D)              (None, 112, 112, 32) 9248        activation_15[0][0]              
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 112, 112, 32) 128         conv2d_17[0][0]                  
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 112, 112, 32) 0           batch_normalization_11[0][0]     
__________________________________________________________________________________________________
conv2d_18 (Conv2D)              (None, 112, 112, 32) 9248        activation_16[0][0]              
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 112, 112, 32) 128         conv2d_18[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 32)           0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
global_max_pooling2d_5 (GlobalM (None, 32)           0           batch_normalization_12[0][0]     
__________________________________________________________________________________________________
reshape_10 (Reshape)            (None, 1, 1, 32)     0           global_average_pooling2d_5[0][0] 
__________________________________________________________________________________________________
reshape_11 (Reshape)            (None, 1, 1, 32)     0           global_max_pooling2d_5[0][0]     
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 1, 1, 4)      132         reshape_10[0][0]                 
                                                                 reshape_11[0][0]                 
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 1, 1, 32)     160         dense_10[0][0]                   
                                                                 dense_10[1][0]                   
__________________________________________________________________________________________________
add_10 (Add)                    (None, 1, 1, 32)     0           dense_11[0][0]                   
                                                                 dense_11[1][0]                   
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 1, 1, 32)     0           add_10[0][0]                     
__________________________________________________________________________________________________
multiply_10 (Multiply)          (None, 112, 112, 32) 0           batch_normalization_12[0][0]     
                                                                 activation_17[0][0]              
__________________________________________________________________________________________________
lambda_10 (Lambda)              (None, 112, 112, 1)  0           multiply_10[0][0]                
__________________________________________________________________________________________________
lambda_11 (Lambda)              (None, 112, 112, 1)  0           multiply_10[0][0]                
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 112, 112, 2)  0           lambda_10[0][0]                  
                                                                 lambda_11[0][0]                  
__________________________________________________________________________________________________
conv2d_19 (Conv2D)              (None, 112, 112, 1)  98          concatenate_5[0][0]              
__________________________________________________________________________________________________
multiply_11 (Multiply)          (None, 112, 112, 32) 0           multiply_10[0][0]                
                                                                 conv2d_19[0][0]                  
__________________________________________________________________________________________________
add_11 (Add)                    (None, 112, 112, 32) 0           activation_15[0][0]              
                                                                 multiply_11[0][0]                
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 112, 112, 32) 0           add_11[0][0]                     
__________________________________________________________________________________________________
conv2d_20 (Conv2D)              (None, 56, 56, 64)   18496       activation_18[0][0]              
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 56, 56, 64)   256         conv2d_20[0][0]                  
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 56, 56, 64)   0           batch_normalization_13[0][0]     
__________________________________________________________________________________________________
conv2d_21 (Conv2D)              (None, 56, 56, 64)   36928       activation_19[0][0]              
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 56, 56, 64)   256         conv2d_21[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 64)           0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
global_max_pooling2d_6 (GlobalM (None, 64)           0           batch_normalization_14[0][0]     
__________________________________________________________________________________________________
reshape_12 (Reshape)            (None, 1, 1, 64)     0           global_average_pooling2d_6[0][0] 
__________________________________________________________________________________________________
reshape_13 (Reshape)            (None, 1, 1, 64)     0           global_max_pooling2d_6[0][0]     
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 1, 1, 8)      520         reshape_12[0][0]                 
                                                                 reshape_13[0][0]                 
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 1, 1, 64)     576         dense_12[0][0]                   
                                                                 dense_12[1][0]                   
__________________________________________________________________________________________________
add_12 (Add)                    (None, 1, 1, 64)     0           dense_13[0][0]                   
                                                                 dense_13[1][0]                   
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 1, 1, 64)     0           add_12[0][0]                     
__________________________________________________________________________________________________
multiply_12 (Multiply)          (None, 56, 56, 64)   0           batch_normalization_14[0][0]     
                                                                 activation_20[0][0]              
__________________________________________________________________________________________________
lambda_12 (Lambda)              (None, 56, 56, 1)    0           multiply_12[0][0]                
__________________________________________________________________________________________________
lambda_13 (Lambda)              (None, 56, 56, 1)    0           multiply_12[0][0]                
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 56, 56, 2)    0           lambda_12[0][0]                  
                                                                 lambda_13[0][0]                  
__________________________________________________________________________________________________
conv2d_23 (Conv2D)              (None, 56, 56, 1)    98          concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_22 (Conv2D)              (None, 56, 56, 64)   2112        activation_18[0][0]              
__________________________________________________________________________________________________
multiply_13 (Multiply)          (None, 56, 56, 64)   0           multiply_12[0][0]                
                                                                 conv2d_23[0][0]                  
__________________________________________________________________________________________________
add_13 (Add)                    (None, 56, 56, 64)   0           conv2d_22[0][0]                  
                                                                 multiply_13[0][0]                
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 56, 56, 64)   0           add_13[0][0]                     
__________________________________________________________________________________________________
conv2d_24 (Conv2D)              (None, 56, 56, 64)   36928       activation_21[0][0]              
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 56, 56, 64)   256         conv2d_24[0][0]                  
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 56, 56, 64)   0           batch_normalization_15[0][0]     
__________________________________________________________________________________________________
conv2d_25 (Conv2D)              (None, 56, 56, 64)   36928       activation_22[0][0]              
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 56, 56, 64)   256         conv2d_25[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 64)           0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
global_max_pooling2d_7 (GlobalM (None, 64)           0           batch_normalization_16[0][0]     
__________________________________________________________________________________________________
reshape_14 (Reshape)            (None, 1, 1, 64)     0           global_average_pooling2d_7[0][0] 
__________________________________________________________________________________________________
reshape_15 (Reshape)            (None, 1, 1, 64)     0           global_max_pooling2d_7[0][0]     
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 1, 1, 8)      520         reshape_14[0][0]                 
                                                                 reshape_15[0][0]                 
__________________________________________________________________________________________________
dense_15 (Dense)                (None, 1, 1, 64)     576         dense_14[0][0]                   
                                                                 dense_14[1][0]                   
__________________________________________________________________________________________________
add_14 (Add)                    (None, 1, 1, 64)     0           dense_15[0][0]                   
                                                                 dense_15[1][0]                   
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 1, 1, 64)     0           add_14[0][0]                     
__________________________________________________________________________________________________
multiply_14 (Multiply)          (None, 56, 56, 64)   0           batch_normalization_16[0][0]     
                                                                 activation_23[0][0]              
__________________________________________________________________________________________________
lambda_14 (Lambda)              (None, 56, 56, 1)    0           multiply_14[0][0]                
__________________________________________________________________________________________________
lambda_15 (Lambda)              (None, 56, 56, 1)    0           multiply_14[0][0]                
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 56, 56, 2)    0           lambda_14[0][0]                  
                                                                 lambda_15[0][0]                  
__________________________________________________________________________________________________
conv2d_26 (Conv2D)              (None, 56, 56, 1)    98          concatenate_7[0][0]              
__________________________________________________________________________________________________
multiply_15 (Multiply)          (None, 56, 56, 64)   0           multiply_14[0][0]                
                                                                 conv2d_26[0][0]                  
__________________________________________________________________________________________________
add_15 (Add)                    (None, 56, 56, 64)   0           activation_21[0][0]              
                                                                 multiply_15[0][0]                
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 56, 56, 64)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv2d_27 (Conv2D)              (None, 56, 56, 64)   36928       activation_24[0][0]              
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 56, 56, 64)   256         conv2d_27[0][0]                  
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 56, 56, 64)   0           batch_normalization_17[0][0]     
__________________________________________________________________________________________________
conv2d_28 (Conv2D)              (None, 56, 56, 64)   36928       activation_25[0][0]              
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 56, 56, 64)   256         conv2d_28[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 64)           0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
global_max_pooling2d_8 (GlobalM (None, 64)           0           batch_normalization_18[0][0]     
__________________________________________________________________________________________________
reshape_16 (Reshape)            (None, 1, 1, 64)     0           global_average_pooling2d_8[0][0] 
__________________________________________________________________________________________________
reshape_17 (Reshape)            (None, 1, 1, 64)     0           global_max_pooling2d_8[0][0]     
__________________________________________________________________________________________________
dense_16 (Dense)                (None, 1, 1, 8)      520         reshape_16[0][0]                 
                                                                 reshape_17[0][0]                 
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 1, 1, 64)     576         dense_16[0][0]                   
                                                                 dense_16[1][0]                   
__________________________________________________________________________________________________
add_16 (Add)                    (None, 1, 1, 64)     0           dense_17[0][0]                   
                                                                 dense_17[1][0]                   
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 1, 1, 64)     0           add_16[0][0]                     
__________________________________________________________________________________________________
multiply_16 (Multiply)          (None, 56, 56, 64)   0           batch_normalization_18[0][0]     
                                                                 activation_26[0][0]              
__________________________________________________________________________________________________
lambda_16 (Lambda)              (None, 56, 56, 1)    0           multiply_16[0][0]                
__________________________________________________________________________________________________
lambda_17 (Lambda)              (None, 56, 56, 1)    0           multiply_16[0][0]                
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 56, 56, 2)    0           lambda_16[0][0]                  
                                                                 lambda_17[0][0]                  
__________________________________________________________________________________________________
conv2d_29 (Conv2D)              (None, 56, 56, 1)    98          concatenate_8[0][0]              
__________________________________________________________________________________________________
multiply_17 (Multiply)          (None, 56, 56, 64)   0           multiply_16[0][0]                
                                                                 conv2d_29[0][0]                  
__________________________________________________________________________________________________
add_17 (Add)                    (None, 56, 56, 64)   0           activation_24[0][0]              
                                                                 multiply_17[0][0]                
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 56, 56, 64)   0           add_17[0][0]                     
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 7, 7, 64)     0           activation_27[0][0]              
__________________________________________________________________________________________________
flatten (Flatten)               (None, 3136)         0           average_pooling2d[0][0]          
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 2)            6274        flatten[0][0]                    
==================================================================================================
Total params: 285,358
Trainable params: 283,982
Non-trainable params: 1,376
__________________________________________________________________________________________________
```

</details>

## Usage
### Data Preprocessing
``` 
train_datagen = ImageDataGenerator(
    rescale = 1./255,
    validation_split=0.2,
)

test_datagen = ImageDataGenerator(
    rescale = 1./255,
)
```
### Train model
```
model.compile(loss='categorical_crossentropy', optimizer=sgd, metrics=['accuracy'])
```
### Fit model
```
history = model.fit(train_dataset, validation_data=valid_dataset , epochs = 10, callbacks=[cb_checkpointer, learning_rate_reduction, logs])
```

## Results
- Resentv1 gave better accuracy than resnetv2 and inceptiov3 in 10 epochs.
- After testing different optimizers, learning rates and batch sizes. The following parametes gave better results.
    - learning rate = 0.001 
    - momentum = 0.9
    - optimizer = SGD
    - batch size = 32

